# Render Blueprint for API Gateway
# This file tells Render how to build and deploy the API Gateway service
# Documentation: https://render.com/docs/blueprint-spec

services:
  - type: web
    name: jm-api-gateway
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    repo: https://github.com/YOUR_USERNAME/YOUR_REPO  # Update with your actual repo URL
    branch: main
    healthCheckPath: /actuator/health
    envVars:
      # Spring Profile
      - key: SPRING_PROFILES_ACTIVE
        value: render

      # Eureka Configuration (point to your deployed Eureka server)
      - key: EUREKA_HOST
        sync: false  # Set this in Render dashboard
      - key: EUREKA_USERNAME
        sync: false
      - key: EUREKA_PASSWORD
        sync: false

      # JWT Configuration (must match auth-service)
      - key: JWT_SECRET
        sync: false  # Set this in Render dashboard - must be at least 256 bits

      # Internal API Key for service-to-service communication
      - key: INTERNAL_API_KEY
        sync: false

      # Redis Configuration (for token revocation cache)
      - key: REDIS_HOST
        sync: false
      - key: REDIS_PORT
        value: "6379"

      # Frontend URL for CORS (your deployed frontend URL)
      - key: FRONTEND_URL
        sync: false  # e.g., https://your-frontend.onrender.com

      # Java options
      - key: JAVA_OPTS
        value: "-Xmx512m -Xms256m"
