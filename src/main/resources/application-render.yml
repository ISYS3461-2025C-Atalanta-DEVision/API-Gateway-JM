# Render Deployment Profile for API Gateway
# This profile is activated when SPRING_PROFILES_ACTIVE=render
# Only contains OVERRIDES - base config is in application.yml

server:
  port: ${PORT:8080}  # Render sets PORT env variable

spring:
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      ssl:
        enabled: ${REDIS_SSL_ENABLED:false}

# CORS - Override for production
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000}

# Eureka - Override for Render deployment
eureka:
  client:
    enabled: ${EUREKA_ENABLED:true}
    service-url:
      defaultZone: ${EUREKA_URL:http://eureka:eureka-secret-2024@localhost:8761/eureka/}
  instance:
    prefer-ip-address: false
    hostname: ${RENDER_EXTERNAL_HOSTNAME:localhost}
    instance-id: ${spring.application.name}:${RENDER_SERVICE_ID:${random.uuid}}
    non-secure-port-enabled: true
    secure-port-enabled: false

# Secrets - No defaults in production (must be set in Render env vars)
internal:
  api-key: ${INTERNAL_API_KEY}

jwt:
  secret: ${JWT_SECRET}

# Production logging - less verbose
logging:
  level:
    root: WARN
    com.devision.jm.gateway: INFO
    org.springframework.cloud.gateway: WARN

# Actuator - more restrictive in production
management:
  endpoint:
    health:
      show-details: when_authorized

# Circuit breaker - longer timeout for cloud
resilience4j:
  timelimiter:
    configs:
      default:
        timeoutDuration: 5s
